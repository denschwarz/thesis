\chapter{Reconstruction of Objects}
\label{ch:Reco}
	At a particle detector like CMS, output signals have to be converted into objects with a physical meaning to perform studies with recorded data. Therefore, algorithms have been developed to identify and reconstruct objects, returning lists of electrons, muons, photons and jets. Each candidate has to fulfil various criteria to be categorized in one of the called groups. Those criteria and algorithms used to obtain suitable objects for a physics approach are described in this chapter.

\section{Particle Flow Algorithm}
\label{sec:pf}
	CMS uses a special algorithm called particle flow (PF) \cite{particleflow} to combine information from every detector system, following the complete path of a particle through the detector. It makes use of the different signatures different particles leave in the detector. Muons are detected in the inner tracker and muon system, electrons are seen in the tracker and ECAL, charged hadrons leave tracks and shower in the HCAL and photons and neutral hadrons only leave energy in the ECAL and HCAL, respectively (see Fig. \ref{fig:CMS_reco}). The particle flow algorithm now utilises these different signatures and combines information of all subdetectors. The goal is, to assign all showers from charged particles to their tracks, leaving only energy deposits originating from photon neutral hadrons. First, hits in the inner tracker and muon system are combined. If a path is found, the object is called a muon candidate and all hits are removed from the algorithm input. Afterwards, the remaining tracks from electrons and charged hadrons are extrapolated into the calorimeter systems and assigned to overlapping showers. Here, photon radiation from electrons has to be treated with, since energy from these photons also has to be assigned to the initial electron. Finally, remaining showers in the ECAL and HCAL should originate from photons and neutral hadron, respectively.	To be able to use particle flow with high efficiency, the tracking systems need to have a good spatial resolution while the calorimeters also have to provide a high granularity. All these requirements are fulfilled in CMS, which makes the PF algorithm a powerful tool in object identification and reconstruction.

	\begin{figure}[tb]
		\centering
		\includegraphics [width=.75\textwidth]{../Images/CMS_Slice_white.png}
		\caption{Slice through the CMS detector looking in direction of the beam pipe. Tracks of different particles on their way through the layers of the detector are displayed. From left to right, you can see the tracker, calorimeters, the superconducting solenoid and the muon system. Taken from \cite{CMSslicewhite}.}
		\label{fig:CMS_reco}
	\end{figure} 
	
\section{Muon Identification}
	Muons have a very low probability to interact with the Calorimeters of CMS. Because of that, muons are identified by hits in the tracker and muon chambers. This property makes muons the objects that can be identified and reconstructed with highest precision. Three working points are defined by the muon reconstruction efficiency. In this analysis the tight working point \cite{MuonID} is used, providing the lowest efficiency but purest muon selection. The criteria a muon candidate has to pass to fulfil the tight working point are:
	\begin{itemize}
	\item the candidate is reconstructed in the inner tracker and muon system
	\item the candidate is reconstructed with PF
	\item the track fit performed by PF returns $\chi^2/ \text{ndof} < 10$, where ndof are the number of degrees of freedom
	\item at least one muon-chamber hit included in the track fit 
	\item the candidate has to be hits in at least two muon stations
	\item Its tracker track has transverse impact parameter $d_{xy} < 2\;\text{mm}$ with respect to the primary vertex 
	\item the longitudinal distance of the tracker track with respect to the primary vertex is $d_{z} < 5\;\text{mm}$
	\item at least one hit in the pixel tracker 
	\item at least hits in five different tracker layers
	\end{itemize}
	If a candidate fulfils these criteria with  with $p_T > 55\;\text{GeV}$ and $|\eta| < 2.4$ it is stored and called muon in this analysis. 
\section{Electron Identification}
	Electrons are reconstructed in the tracker and electromagnetic calorimeter. Due to the magnetic field, electrons will take a curved path through the tracking system. They are then stopped in the ECAL where their energy is measured. In contradiction to muons, electrons are difficult to identify because of various effects. Because of their low mass electrons radiate Bremsstrahlung at a high rate which has to be thought of in reconstruction procedure. Additionally, electrons from photon conversion have to be suppressed. Finally, electromagnetic showers in the ECAL from photons and electrons have to be distinguished. Again, working points are defined analogously to muons. This analysis uses electrons that fulfil the medium criteria, corresponding to a efficiency of about $80\%$. For electron identification a multi-variant approach is used, taking following quantities into account:
	\begin{itemize}
	\item shower shape in $\eta$-direction
	\item distances in $\eta$ and $\phi$ between the track extrapolated to the ECAL and shower itself
	\item ratio of energy deposited in the ECAL and the HCAL behind it
	\item value of $|\frac{1}{E} - \frac{1}{p}|$ of the electron candidate, where $E$ is calculated from calorimetry and $p$ is taken from the tracker
	\item transverse impact parameter $d_{xy}$
	\item longitudinal impact parameter $d_{z}$
	\item not more than two missing hits in in the tracking system
	\end{itemize}
	Only electrons fulfilling the medium requirements with $p_T > 55\;\text{GeV}$ and $|\eta| < 2.4$ are considered in this work.
\section{Jet Reconstruction}
%todo Softdrop?
	Jets are objects, used to reconstruct quarks. Because of confinement quarks cannot exist isolated but hadronize. This results in a particle shower consisting of hadrons. To reconstruct the initial quark one needs to sum up all particles from the final shower. To combine the tracks in a well defined way jet algorithms are used. Two important requirements for an jet algorithm are to be infrared and collinear safe. The first criterion means, a jet should not change when including or excluding soft radiation. Collinear safety addresses collinear splitting of particles in a jet which should also not change the jet. All presented jet algorithms in this thesis fulfil these requirements. Additionally, only jets with $p_T > 30\;\text{GeV}$ and $|\eta| < 2.4$ are considered in this analysis.
\subsection{Anti-$k_T$ and Cambridge/Aachen Jet Algorithms}
	In CMS the common way to cluster jets from the detected particles is to use iterative jet algorithms. Thus particles are clustered step by step until an abort criterion is reached. The most common group of iterative jet algorithms are $k_T$-like algorithms. As an input, a list of objects reconstructed in the detector is given. The Algorithm then calculates two quantities $d_{ij}$ (Eq. \ref{eq:dij}) and $d_{iB}$ (Eq. \ref{eq:iB}) for each pair of objects $i$ and $j$:
	\begin{equation}
	d_{ij} = min (k_{T,i}^{n}, k_{T,j}^{n})  \frac{\Delta R_{ij}^2}{R^2}
	\label{eq:dij}
	\end{equation}
	\begin{equation}
	d_{iB} = k_{T,i}^{-n}.
	\label{eq:iB}
	\end{equation}
	Here, $d_{ij}$ describes a effective distance between two objects $i$ and $j$, $d_{iB}$ is a distance measure from object to beam axis. The variable $k_T$ is the transverse momentum of an object, $\Delta R_{ij}$ denotes the distance between objects $i$ and $j$ and $R$ is a constant parameter that defines the radius of the resulting jet. Changing the exponent $n$ influences the order of clustering. If $n=-2$, the algorithm is called Anti-$k_T$ \cite{antikt} and particles with high transverse momenta are clustered first. Using the Cambridge/Aachen \cite{CA1, CA2} algorithm, and therefore choosing $n=0$ will not weight the objects by momenta and provides a pure geometrical measure. When $d_{ij}$ is smaller than $d_{iB}$ both objects $i$ and $j$ are combined and both quantities are calculated again. At some point, $d_{iB}$ will be smaller than any $d_{ij}$, then object $i$ is called a jet and is removed from the list of objects. This procedure is repeated until the list of objects is empty. With the anti-$k_T$ jet algorithm, particles with large transverse momenta are clustered first because $d_{ij}$ (Eq. \ref{eq:dij}) is easily smaller then $d{iB}$ for large $p_T$. The resulting jets are very circular. 
	%todo plot mit AK shape.
	%todo KT auch erwÃ¤hnen?

\subsection{HOTVR Jet Algorithm}
	Another approach to cluster jets is the 'heavy object tagger with variable R' (HOTVR) \cite{hotvr}. This algorithm does not use a constant radius parameter $R$ but a $p_T$ dependent effective $R=R_\text{eff}(p_T)$ (see Eq. \ref{eq:HOTVR}). Thus the $R_\text{eff}$ decreases with increasing $p_T$ leading to smaller jets when the decay products are expected to be more close because of the Lorentz boost. The $p_T$ dependence is scaled with a parameter $\rho$ with a default value of $600\;\text{GeV}$. Furthermore, upper and lower boundaries for the jet radius can be set. The default values are $R_\text{min} = 0.1$ and $R_\text{max} = 1.5$. 	
	\begin{equation}
	\label{eq:HOTVR}
	  R_\text{eff} =
	   \begin{cases}
	     R_\text{min} & \text{for } \rho / p_T < R_\text{min} \\
	     R_\text{max} & \text{for } \rho / p_T > R_\text{max} \\
	     \rho / p_T & \text{else}  
	   \end{cases}
	\end{equation}
	
	\noindent This effective $R$ is then used with the equations of the Anti-$k_T$ algorithm described earlier (see Eq. \ref{eq:dij} - \ref{eq:iB}). Additionally, a mass-jump criterion is used.
	%todo mass jump Kriterium, auch mit Formel
	

\subsection{XCone Jet Algorithm}
\label{sec:xcone}
	XCone \cite{xcone} is an exclusive jet algorithm, returning conical jets. It is well suited for analysis where the final state and therefore the expected number of jets is known since it returns a fixed number of jets. Thus, a physical final state has direct influence on the jet finding. \\
	Starting with a fixed number of jet axes $N$ the algorithm calculates the direction of these axes by minimizing the N-jettiness variable. N-jettiness is a measure for how N-jet-like an event looks. The definition is shown in Eq. \ref{njettines}.
	\begin{equation}
	\tilde{\tau}_N = \sum_i \min\{\rho_\text{jet}(p_i, n_1), \dots, \rho_\text{jet}(p_i, n_N), \rho_\text{beam}(p_i)\}
	\label{njettines}
	\end{equation}
	Once the minimizing process converges, all particles inside a radius $R$ from a jet axis are added to one jet. Here, it is important to mention that XCone handles overlapping jets differently than common iterative jet algorithms. HOTVR and the Anti-$k_T$ algorithm remove already clustered objects from the input list. Thus, one of two nearby jets is crescent shaped while the other one is circular. XCone however, will assign every object to the closest jet resulting in a straight border between two jets. This feature is shown in Fig. \ref{fig:XCone_overlap}. 
	\begin{figure}[tb]
		\centering
		\includegraphics [width=.6\textwidth]{../Plots/XCone_Overlap.png}
		\caption{The separation of nearby jets clustered with the XCone jet algorithm in a $t\bar{t}$ event, requiring six jets with a radius of $0.5$, is depicted. The area of jets is shown in the $\phi$-$y$-plane. Here $y$ indicates the rapidity. Taken from \cite{xcone}.}
		\label{fig:XCone_overlap}
	\end{figure} 
	A more general advantage of XCone is that the N-jettiness variable is often used to do theory calculations of particle physics events, the XCone algorithm is easier to include in these calculations.
	
\subsection{Jet Energy Corrections}
\label{sec:jec}
	Jets found by clustering sequences are furthermore corrected to account for non linearities in the detector response and differences between data and simulation because of modelling \cite{JEC}. The approach is to factorize different sources of variance and scale momentum vectors of jets with a factor addressing each source. Thus, four factors are introduced which then result in one final $p_T$ and $\eta$ dependent correction factor as shown in Eq. \ref{eq:jec} and \ref{eq:cjec}.
	\begin{equation}
	p^{\text{corrected}} = C_{\text{JEC}} \cdot p^{\text{raw}}
	\label{eq:jec}
	\end{equation}
	where
	\begin{equation}
	C_{\text{JEC}} = C_{\text{offset}} \cdot C_{\text{MC}} \cdot C_{\text{rel}} \cdot C_{\text{abs}}
	\label{eq:cjec}
	\end{equation}
	Firstly, a factor is applied to address the additional energy in a jet because of pile-up ($C_{\text{offset}}$), which is not taken care of in simulation. The factor is constructed $p_T$ dependent to subtract a constant energy from a jet in data. Secondly, reconstructed jets are corrected to match the generated jet momentum. This is done by calculating a factor $R=\frac{p_T^{\text{rec}}}{p_T^{\text{gen}}}$ in different $p_T$ and $\eta$ regions and apply this to reconstructed jets as $C_{\text{MC}} = \frac{1}{<R>}$, where $<R>$ indicates a mean in the given region. Next, a relative correction $C_{\text{rel}}$ is applied which accounts for non linearities in the detector response. Therefore, a $\eta$ dependent correction factor is used. Lastly, an absolute factor $\cdot C_{\text{abs}}$ derived from data in $Z$ + jets and $\gamma$ + jets events to fit the absolute energy scale.

\subsection{b-Jets}
\label{sec:btag}
	In analyses involving top quarks, it is useful to identify bottom quarks since they are in almost every case one of the top decay products. The properties of the b-quark makes it possible to find and tag jets originating from a bottom quark. Since b-hadrons have a relatively large lifetime of about $1.5\;\text{ps}$, combined with time dilatation due to their velocity, the are likely to travel several millimetres in the detector before decaying. This leads to a secondary vertex at the spatial point where the b-hadron decays. The high precision tracking system of CMS makes it possible to resolve both, primary and secondary vertex. These characteristics are exploited by the Combined Secondary Vertex (CSV) algorithm \cite{csv} and its updated version CSVv2 \cite{btag}. Furthermore, the fraction of energy from charged hadrons in a jet and the invariant mass of all particles assigned to a secondary vertex are taken into account. As a result, the CSVv2 returns a number from $0$ to $1$, indicating how b-jet like a jet is. Different working point in b-tagging correspond to different minimum values a jet has to fulfil to be considered a b-jet. In this analysis, the tight working point, corresponding to a minimum value of $0.935$, is used.
	
\section{$\cancel{E}_T$ and $S_T$}
	With the information of mentioned objects two important variables are defined. The missing transverse energy $\cancel{E}_T$ is defined to estimate the energy carried away by particles which leave the experiment undetected. Summing up all transverse momenta of each particle in the final state returns the $p_T$ of the system in the initial state which is $p_T = 0$ at LHC. Thus the transverse energy of all undetected particles is defined as the absolute value of the negative sum over all transverse momenta of detected objects (Eq. \ref{eq:MET}). Since every object, independent from it's $\eta$, has to be taken into account for this variable, $\cancel{E}_T$ is independent from the selection applied. The missing energy is due to neutrinos which can not be detected with CMS because of their low probability to interact with the detector material or a new physics state. 
	
	\begin{equation}
		\cancel{E}_T = \left| - \sum_{\textrm{leptons, jets}}^{} \vec{p}_T \right|
		\label{eq:MET}
	\end{equation}
	
	\noindent Another important variable to describe an event is $S_T$. As represented in Eq. \ref{eq:ST} is defined as the scalar sum of all transverse momenta of reconstructed objects plus the missing transverse energy mentioned above. Different from $\cancel{E}_T$ only objects surviving the selection are considered. $S_T$ gives an estimate how much energy one event contains and is therefore used to distinguish between low energy QCD and high energy processes. 
	
	\begin{equation}
		S_T = \left( \sum_{\textrm{leptons, jets}}^{} \vert \vec{p}_T \vert \right) + \cancel{E}_T
		\label{eq:ST}
	\end{equation}
	
	\noindent Additionally, a definition for $S_T$ which just takes leptonic activity into account is used in this analysis. It is similarly defined and referred to as $S_T^{\text{lep}}$ (see Eq. \ref{eq:STlep}).
	
	\begin{equation}
		S_T^\text{lep} = \left( \sum_{\textrm{leptons}}^{} \vert \vec{p}_T \vert \right) + \cancel{E}_T
		\label{eq:STlep}
	\end{equation}	
